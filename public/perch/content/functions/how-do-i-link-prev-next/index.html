<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Previous and Next Links in content - Perch CMS documentation</title>
  <meta name="description" content="Perch documentation">
  <meta property="og:title" content="Previous and Next Links in content">
  <meta property="og:description" content="Perch documentation">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link href="/assets/css/docs.css" rel="stylesheet">
  <script type="text/javascript" src="//use.typekit.net/kiw6gix.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  

</head>
<body>
  <nav class="global-bar show-for-small-only">
    <ul class="nav-products">
        <li class="docs"><a href="https://docs.grabaperch.com">Docs</a></li>
    </ul>
    <a href="?nav=show" class="hamburger">☰</a>
</nav>
<nav class="global-bar primary show-for-medium">
    <ul class="nav-products">
        <li class="perch"><a href="https://grabaperch.com">Perch</a></li>
        <li class="runway"><a href="https://perchrunway.com">Runway</a></li>
        <li class="shop"><a href="https://shop.perchcms.com">Perch Shop</a></li>
        <li class="addons first-right"><a href="https://grabaperch.com/add-ons">Add-ons</a></li>
        <li class="selected docs"><a href="https://docs.grabaperch.com">Docs</a></li>
        <li class="support"><a href="https://community.perchcms.com/forum/">Support</a></li>
        <li class="account"><a href="https://account.perchcms.com">Account</a></li>
    </ul>
</nav>
<nav class="site-nav">
    <ul>
        <li class="home-link selected"><a href="/perch/">Perch Docs</a></li>
        <li><a href="/runway/">Runway Docs</a></li>
        <li><a href="/video/">Video</a></li>
        <li><a href="/templates/">Template Reference</a></li>
        <li><a href="/functions/">Function Reference</a></li>
        <li><a href="/addons/">Add-ons</a></li>
        <li><a href="/api/">API</a></li>
    </ul>

    <div class="global-search" role="search">
      <div class="gcse-searchbox"></div>
    </div>

    <style>
      .custom-search {
        with
      }
  
      table.gsc-input {
        margin: 0;
        height: 1.5em;
      }

      form.gsc-search-box {
        margin: 0;
      }

      .gsc-search-box tbody {
        border: none;
      }

      .gsc-search-box tbody td {
        padding: 0;
      }

      .gsc-control-cse {
        padding: 0;
      }

      .gsc-input-box {
        border: none;
      }

      .gsc-search-box a {
        padding: 0;
      }
    </style>
</nav>

<div class="gcse-searchresults"></div>
<main class="wrapper">
    <nav class="sidebar">
    <ul class="sidenav">
                        <li>
                            <a href="/perch/getting-started/">Getting Started With Perch</a>
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/configuration/">Configuration</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/building/">Building Sites with Perch</a>
                             
                             
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/categories/">Categories</a>
                             
                        </li>
                        <li>
                            <a href="/perch/content/">Working with Content</a>
                            <ul>    <li>
                            <a href="/perch/content/functions/">Functions</a>
                            <ul>    <li>
                            <a href="/perch/content/functions/content-from-multiple-pages-and-regions/">Combining Content from Several Regions</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/create-a-prepopulated-region/">Pre-populating Template Regions</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/get-content-before-templating/">Accessing content before it is templated</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/how-do-i-add-an-rss-feed/">Adding an RSS Feed</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/how-do-i-create-a-faq/">Creating a FAQ</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/how-do-i-create-a-google-sitemap/">Create a Google Sitemap</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/how-do-i-create-list-detail-pages/">Create a list detail page</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/how-do-i-link-prev-next/" class="selected">Previous and Next Links in content</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/passing-options-to-custom-functions/">How to pass options to custom functions</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/show-one-random-item/">Display an item at random</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/sorting-data/">Sorting data</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/two-page-list-and-detail/">Two page list and detail</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/functions/user-filtered-lists/">A user-filtered list</a>
                        </li>
                    </ul>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/content/templates/">Templates</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
                    </ul>
                        </li>
                        <li>
                            <a href="/perch/control-panel/">The Perch Control Panel</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/help/">Troubleshooting Tips</a>
                        </li>
                        <li>
                            <a href="/perch/pages-and-nav/">Pages and Navigation</a>
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/resources/">Managing Resources</a>
                             
                        </li>
                        <li>
                            <a href="/perch/upgrading/">Upgrading to Perch 3</a>
                        </li>
    </ul>  </nav>

<article class="content">


  <h1>Previous and Next Links in content</h1>

  <p><strong>How do I create links to previous and next items?</strong></p>
<p>When using a multiple item region, particularly with a list/detail display, it is sometimes useful to be able to link to the next or previous item in that region. This can be done with some simple filtering and ordering using <code>perch_content_custom()</code></p>
<p>Here’s the scenario; we have a multiple item region set up using the <a href="/architecture/how-do-i-create-list-detail-pages">list and detail</a> approach. On the detail page, it would be great to be able to show links to the previous and next items in the list, with the user needing to navigate back to the list to find them.</p>
<p>To do this we need three <code>perch_content_custom()</code> calls:</p>
<ol>
<li>The original call that finds the main item we’re looking at</li>
<li>A call to find the previous item</li>
<li>A call to find the next item</li>
</ol>
<h2 id="modifying-the-main-call">Modifying the main call</h2>
<p>Taking the example from the <a href="/architecture/how-do-i-create-list-detail-pages">list and detail</a> solution, our <code>perch_content_custom()</code> call used to show the detail view looks like this:</p>
<pre><code class="lang-php">perch_content_custom(&#39;Products&#39;, array(
    &#39;template&#39; =&gt; &#39;product_detail.html&#39;,
    &#39;filter&#39;   =&gt; &#39;slug&#39;,
    &#39;match&#39;    =&gt; &#39;eq&#39;,
    &#39;value&#39;    =&gt; perch_get(&#39;s&#39;),
    &#39;count&#39;    =&gt; 1,
));
</code></pre>
<p>We need to make an important change to this in order to have the information we need to find the next and previous items. We need to use the <code>skip-template</code> option to return the raw content, and then use the <code>return-html</code> option to make sure we get the HTML back too.</p>
<p>The result looks like this:</p>
<pre><code class="lang-php">$result = perch_content_custom(&#39;Products&#39;, array(
    &#39;template&#39;      =&gt; &#39;product_detail.html&#39;,
    &#39;filter&#39;        =&gt; &#39;slug&#39;,
    &#39;match&#39;         =&gt; &#39;eq&#39;,
    &#39;value&#39;         =&gt; perch_get(&#39;s&#39;),
    &#39;count&#39;         =&gt; 1,
    &#39;skip-template&#39; =&gt; true,
    &#39;return-html&#39;   =&gt; true,
));
</code></pre>
<p>Because of the <code>skip-template</code>, this call won’t output anything to the page. We need to do that with a simple <code>echo</code> statement:</p>
<pre><code class="lang-php">echo $result[&#39;html&#39;];
</code></pre>
<p>This leaves us with the main detail item being output to the page just as before, but now we have the raw content fields also available to us in the variable <code>$result</code>.</p>
<h2 id="creating-the-template">Creating the template</h2>
<p>To show the previous and next items, we need a template. This can be anything from a simple link, to a mini preview of the content item. You have the full range of content available, including images and so on.</p>
<p>Save this as <code>product_prevnext.html</code> in your templates folder.</p>
<pre><code class="lang-html">&lt;a href=&quot;?s=&lt;perch:content id=&quot;slug&quot; type=&quot;slug&quot;&gt;&quot;&gt;
    &lt;perch:if exists=&quot;is_prev&quot;&gt;Previous&lt;perch:else&gt;Next&lt;/perch:if&gt;:
    &lt;perch:content id=&quot;image&quot; type=&quot;image&quot; width=&quot;100&quot; height=&quot;100&quot; crop output=&quot;tag&quot;&gt;
    &lt;perch:content id=&quot;title&quot; type=&quot;text&quot;&gt;
&lt;/a&gt;
</code></pre>
<h2 id="finding-the-next-item">Finding the Next item</h2>
<p>To find the next item, the logic is simple:</p>
<ol>
<li>Sort the region</li>
<li>Filter for just the items that come <em>after</em> our main item in the list</li>
<li>Take the first one of those left</li>
</ol>
<p>Remember we have our main item stored in the variable <code>$result</code>, so we can make use of that here.</p>
<pre><code class="lang-php">perch_content_custom(&#39;Products&#39;, array(
    &#39;template&#39;   =&gt; &#39;product_prevnext.html&#39;,
    &#39;filter&#39;     =&gt; &#39;_order&#39;,
    &#39;match&#39;      =&gt; &#39;gt&#39;,
    &#39;value&#39;      =&gt; $result[0][&#39;_sortvalue&#39;],
    &#39;sort&#39;       =&gt; &#39;_order&#39;,
    &#39;sort-order&#39; =&gt; &#39;ASC&#39;,
    &#39;count&#39;      =&gt; 1,
));
</code></pre>
<p>There’s a neat trick at play here. We’re filtering on a special value of <code>_order</code>. This is the ‘natural’ order of the items within the region. According to this filter, the <code>_order</code> needs to be greater than (<code>gt</code>) the <code>_sortvalue</code> of the main item.</p>
<p><code>_sortvalue</code> is the other part of the trick. This is the value that was used for sorting when the main item was found. So if it was found using the natural order (no sort value) then it would be its <code>_order</code>. If you sorted by another field, say price, then <code>_sortvalue</code> would be the price. This enables you to figure out a relational order between items no matter how they’re sorted.</p>
<p>We’re sorting by the regions natural order, and filtering where the position in that order is greater than the main item’s position. And then just taking the first result.</p>
<h2 id="finding-the-previous-item">Finding the Previous item</h2>
<p>The process for the previous item is just the same, but we reverse the filtering and ordering. We need to find the items whose order puts them before our main item in the list, and then just pick off the last one. We don’t have the tools to pick off the last one, so we reverse the order (<code>&#39;sort-order&#39;=&gt;&#39;DESC&#39;</code>) and pick off the first.</p>
<p>We also need to set that <code>is_prev</code> value that our template is using to display the correct labels.</p>
<pre><code class="lang-php">PerchSystem::set_var(&#39;is_prev&#39;, true);

perch_content_custom(&#39;Products&#39;, array(
    &#39;template&#39;   =&gt; &#39;product_prevnext.html&#39;,
    &#39;filter&#39;     =&gt; &#39;_order&#39;,
    &#39;match&#39;      =&gt; &#39;lt&#39;,
    &#39;value&#39;      =&gt; $result[0][&#39;_sortvalue&#39;],
    &#39;sort&#39;       =&gt; &#39;_order&#39;,
    &#39;sort-order&#39; =&gt; &#39;DESC&#39;,
    &#39;count&#39;      =&gt; 1,
));
</code></pre>
<p>That gives us our previous item.</p>
<h2 id="sorting-by-a-particular-field">Sorting by a particular field</h2>
<p>If you want to sort the region by something other than its natural order, you just need to set the same <code>sort</code> option on all three <code>perch_content_custom()</code> calls, and update the <code>filter</code> on the previous and next items to use that field too.</p>

</article>




</main>
<footer>
</footer>
<script async src="https://cse.google.com/cse.js?cx=007560778035763025039:043iekruiov"></script>
<script src="/assets/js/prism.js" async defer></script>
<script>
    if ("classList" in document.createElement("_")) {
        var hb = document.querySelectorAll('.hamburger');
        if (hb.length) {
            hb[0].addEventListener('click', function(e) {
                e.preventDefault();
                var nav = document.querySelectorAll('nav.primary')[0];
                if (!nav.classList.contains('show')) {
                    nav.classList.remove('show-for-medium', 'hide');
                    nav.classList.add('show');
                } else {
                    nav.classList.remove('show');
                    nav.classList.add('hide');
                }
            });
        }
    }


        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8618320-3']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

</script>
</body>
</html>
