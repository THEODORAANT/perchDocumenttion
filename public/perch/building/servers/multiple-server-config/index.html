<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Multiple Server Config Files - Perch CMS documentation</title>
  <meta name="description" content="Perch documentation">
  <meta property="og:title" content="Multiple Server Config Files">
  <meta property="og:description" content="Perch documentation">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link href="/assets/css/docs.css" rel="stylesheet">
  <script type="text/javascript" src="//use.typekit.net/kiw6gix.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  

</head>
<body>
  <nav class="global-bar show-for-small-only">
    <ul class="nav-products">
        <li class="docs"><a href="https://docs.grabaperch.com">Docs</a></li>
    </ul>
    <a href="?nav=show" class="hamburger">☰</a>
</nav>
<nav class="global-bar primary show-for-medium">
    <ul class="nav-products">
        <li class="perch"><a href="https://grabaperch.com">Perch</a></li>
        <li class="runway"><a href="https://perchrunway.com">Runway</a></li>
        <li class="shop"><a href="https://shop.perchcms.com">Perch Shop</a></li>
        <li class="addons first-right"><a href="https://grabaperch.com/add-ons">Add-ons</a></li>
        <li class="selected docs"><a href="https://docs.grabaperch.com">Docs</a></li>
        <li class="support"><a href="https://community.perchcms.com/forum/">Support</a></li>
        <li class="account"><a href="https://account.perchcms.com">Account</a></li>
    </ul>
</nav>
<nav class="site-nav">
    <ul>
        <li class="home-link selected"><a href="/perch/">Perch Docs</a></li>
        <li><a href="/runway/">Runway Docs</a></li>
        <li><a href="/video/">Video</a></li>
        <li><a href="/templates/">Template Reference</a></li>
        <li><a href="/functions/">Function Reference</a></li>
        <li><a href="/addons/">Add-ons</a></li>
        <li><a href="/api/">API</a></li>
    </ul>

    <div class="global-search" role="search">
      <div class="gcse-searchbox"></div>
    </div>

    <style>
      .custom-search {
        with
      }
  
      table.gsc-input {
        margin: 0;
        height: 1.5em;
      }

      form.gsc-search-box {
        margin: 0;
      }

      .gsc-search-box tbody {
        border: none;
      }

      .gsc-search-box tbody td {
        padding: 0;
      }

      .gsc-control-cse {
        padding: 0;
      }

      .gsc-input-box {
        border: none;
      }

      .gsc-search-box a {
        padding: 0;
      }
    </style>
</nav>

<div class="gcse-searchresults"></div>
<main class="wrapper">
    <nav class="sidebar">
    <ul class="sidenav">
                        <li>
                            <a href="/perch/getting-started/">Getting Started With Perch</a>
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/configuration/">Configuration</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/building/">Building Sites with Perch</a>
                            <ul>    <li>
                            <a href="/perch/building/hosts/">Webhosts</a>
                             
                             
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/how-do-i-create-a-multilingual-site/">Create a multilingual site</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/integrations/">Integrations</a>
                             
                             
                             
                             
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/servers/">Servers</a>
                            <ul>    <li>
                            <a href="/perch/building/servers/email-testing-with-mailtrap/">Local testing of email with Mailtrap</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/servers/how-do-i-get-started-with-php/">Getting Started with PHP</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/servers/how-do-i-move-a-perch-site/">How do I move a Perch site?</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/servers/installing-a-local-server-with-xampp/">Installing XAMPP for local development</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/servers/multiple-server-config/" class="selected">Multiple Server Config Files</a>
                        </li>
                    </ul>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/troubleshooting/">Troubleshooting</a>
                             
                             
                             
                             
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/updating/">Updating Perch</a>
                             
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/perch/building/working-with-front-controllers/">Working with Front Controllers</a>
                        </li>
                    </ul>
                        </li>
                        <li>
                            <a href="/perch/categories/">Categories</a>
                             
                        </li>
                        <li>
                            <a href="/perch/content/">Working with Content</a>
                             
                             
                        </li>
                        <li>
                            <a href="/perch/control-panel/">The Perch Control Panel</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/help/">Troubleshooting Tips</a>
                        </li>
                        <li>
                            <a href="/perch/pages-and-nav/">Pages and Navigation</a>
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/perch/resources/">Managing Resources</a>
                             
                        </li>
                        <li>
                            <a href="/perch/upgrading/">Upgrading to Perch 3</a>
                        </li>
    </ul>  </nav>

<article class="content">


  <h1>Multiple Server Config Files</h1>

  <p><strong>How do I create a config file that will work on multiple servers?</strong></p>
<p>If you have a local, staging and live version of your Perch site then every time you move your files you have to be careful not to overwrite the config file. This solution explains how to create a file that switches on the hostname, meaning that it is safe to upload to all of your locations.</p>
<p>If you have a local, staging and live version of your Perch site then every time you move your files you have to be careful not to overwrite the config file. This solution explains how to create a file that switches on the hostname, meaning that it is safe to upload to all of your locations.</p>
<p>The default Perch config file looks like this:</p>
<pre><code class="lang-php">    &lt;?php
    define(&#39;PERCH_LICENSE_KEY&#39;, &#39;P21001-XXXXXX-XXXXXX-XXXXXX-XXXXXX&#39;);

    define(&quot;PERCH_DB_USERNAME&quot;, &#39;root&#39;);
    define(&quot;PERCH_DB_PASSWORD&quot;, &#39;xxxxxx&#39;);
    define(&quot;PERCH_DB_SERVER&quot;, &quot;localhost&quot;);
    define(&quot;PERCH_DB_DATABASE&quot;, &quot;db-site1&quot;);

    define(&#39;PERCH_EMAIL_FROM&#39;, &#39;me@mydomain.com&#39;);
    define(&#39;PERCH_EMAIL_FROM_NAME&#39;, &#39;Rachel Andrew&#39;);

    define(&#39;PERCH_LOGINPATH&#39;, &#39;/perch&#39;);
    define(&#39;PERCH_PATH&#39;, str_replace(DIRECTORY_SEPARATOR.&#39;config&#39;, &#39;&#39;, dirname(__FILE__)));
    define(&#39;PERCH_CORE&#39;, PERCH_PATH.DIRECTORY_SEPARATOR.&#39;core&#39;);


    define(&#39;PERCH_RESFILEPATH&#39;, PERCH_PATH . DIRECTORY_SEPARATOR . &#39;resources&#39;);
    define(&#39;PERCH_RESPATH&#39;, PERCH_LOGINPATH . &#39;/resources&#39;);

    define(&#39;PERCH_HTML5&#39;, true);

    ?&gt;
</code></pre>
<p>The bits we are concerned with are those which are different from one server to another, essentially these four lines:</p>
<pre><code class="lang-php">    define(&quot;PERCH_DB_USERNAME&quot;, &#39;root&#39;);
    define(&quot;PERCH_DB_PASSWORD&quot;, &#39;xxxxxx&#39;);
    define(&quot;PERCH_DB_SERVER&quot;, &quot;localhost&quot;);
    define(&quot;PERCH_DB_DATABASE&quot;, &quot;db-site1&quot;);
</code></pre>
<p>Ideally things like your DB prefix, location of resources and the name of the Perch folder would be the same in all locations as you should try and replicate the live environment as much as possible.</p>
<p>We are going to use PHP to look at the hostname of the server we are currently on, and create a switch statement that will call a different set of credentials in depending on what that hostname is.</p>
<p>Just below your license key, using a plain text editor add the following line:</p>
<pre><code class="lang-php">    $http_host = getenv(&#39;HTTP_HOST&#39;);
</code></pre>
<p>Now we create the switch statement using each of the values you have set up as domains for this license, this should replace the four lines defining this information:</p>
<pre><code class="lang-php">    switch($http_host)
    {
        case(&#39;mysite.local&#39;) :

            define(&quot;PERCH_DB_USERNAME&quot;, &#39;root&#39;);
            define(&quot;PERCH_DB_PASSWORD&quot;, &#39;xxxxxx&#39;);
            define(&quot;PERCH_DB_SERVER&quot;, &quot;localhost&quot;);
            define(&quot;PERCH_DB_DATABASE&quot;, &quot;db-site1&quot;);
            break;

        case(&#39;mysite.my-staging-server.com&#39;) :
            define(&quot;PERCH_DB_USERNAME&quot;, &#39;staging_username&#39;);
            define(&quot;PERCH_DB_PASSWORD&quot;, &#39;staging_password&#39;);
            define(&quot;PERCH_DB_SERVER&quot;, &quot;localhost&quot;);
            define(&quot;PERCH_DB_DATABASE&quot;, &quot;db-staging-database&quot;);
            break;

        default :
            define(&quot;PERCH_DB_USERNAME&quot;, &#39;mysite_user&#39;);
            define(&quot;PERCH_DB_PASSWORD&quot;, &#39;mysite_password&#39;);
            define(&quot;PERCH_DB_SERVER&quot;, &quot;localhost&quot;);
            define(&quot;PERCH_DB_DATABASE&quot;, &quot;db-mysite&quot;);
            break;
        }
</code></pre>
<p>Essentially all the above is saying is that if the value in the parentheses after case matches the variable in $http_host, use this set of definitions. You just need to change the value in parentheses to match your sites.</p>
<p>I would suggest making the live domain default – that way it will be used whether you have www or not in front of the domain, or in the case of having multiple domains pointed to one site.</p>
<p>You can save the file and – assuming the details are correct – this will now work in each of the locations and you don’t need to worry about overwriting it.</p>

</article>




</main>
<footer>
</footer>
<script async src="https://cse.google.com/cse.js?cx=007560778035763025039:043iekruiov"></script>
<script src="/assets/js/prism.js" async defer></script>
<script>
    if ("classList" in document.createElement("_")) {
        var hb = document.querySelectorAll('.hamburger');
        if (hb.length) {
            hb[0].addEventListener('click', function(e) {
                e.preventDefault();
                var nav = document.querySelectorAll('nav.primary')[0];
                if (!nav.classList.contains('show')) {
                    nav.classList.remove('show-for-medium', 'hide');
                    nav.classList.add('show');
                } else {
                    nav.classList.remove('show');
                    nav.classList.add('hide');
                }
            });
        }
    }


        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8618320-3']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

</script>
</body>
</html>
