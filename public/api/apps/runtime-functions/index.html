<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Runtime functions - Perch CMS documentation</title>
  <meta name="description" content="Perch documentation">
  <meta property="og:title" content="Runtime functions">
  <meta property="og:description" content="Perch documentation">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link href="/assets/css/docs.css" rel="stylesheet">
  <script type="text/javascript" src="//use.typekit.net/kiw6gix.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  

</head>
<body>
  <nav class="global-bar show-for-small-only">
    <ul class="nav-products">
        <li class="docs"><a href="https://docs.grabaperch.com">Docs</a></li>
    </ul>
    <a href="?nav=show" class="hamburger">☰</a>
</nav>
<nav class="global-bar primary show-for-medium">
    <ul class="nav-products">
        <li class="perch"><a href="https://grabaperch.com">Perch</a></li>
        <li class="runway"><a href="https://perchrunway.com">Runway</a></li>
        <li class="shop"><a href="https://shop.perchcms.com">Perch Shop</a></li>
        <li class="addons first-right"><a href="https://grabaperch.com/add-ons">Add-ons</a></li>
        <li class="selected docs"><a href="https://docs.grabaperch.com">Docs</a></li>
        <li class="support"><a href="https://community.perchcms.com/forum/">Support</a></li>
        <li class="account"><a href="https://account.perchcms.com">Account</a></li>
    </ul>
</nav>
<nav class="site-nav">
    <ul>
        <li class="home-link"><a href="/perch/">Perch Docs</a></li>
        <li><a href="/runway/">Runway Docs</a></li>
        <li><a href="/video/">Video</a></li>
        <li><a href="/templates/">Template Reference</a></li>
        <li><a href="/functions/">Function Reference</a></li>
        <li><a href="/addons/">Add-ons</a></li>
        <li class="selected"><a href="/api/">API</a></li>
    </ul>

    <div class="global-search" role="search">
      <div class="gcse-searchbox"></div>
    </div>

    <style>
      .custom-search {
        with
      }
  
      table.gsc-input {
        margin: 0;
        height: 1.5em;
      }

      form.gsc-search-box {
        margin: 0;
      }

      .gsc-search-box tbody {
        border: none;
      }

      .gsc-search-box tbody td {
        padding: 0;
      }

      .gsc-control-cse {
        padding: 0;
      }

      .gsc-input-box {
        border: none;
      }

      .gsc-search-box a {
        padding: 0;
      }
    </style>
</nav>

<div class="gcse-searchresults"></div>
<main class="wrapper">
    <nav class="sidebar">
    <ul class="sidenav">
                        <li>
                            <a href="/api/apps/">Apps</a>
                            <ul>    <li>
                            <a href="/api/apps/registering/">Registering</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/activating/">Activation</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/settings/">Adding Settings</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/runtime-functions/" class="selected">Runtime functions</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/field-types/">Field types</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/scheduled-tasks/">Scheduled tasks</a>
                        </li>
                    </ul>
                            <ul>    <li>
                            <a href="/api/apps/upgrading/">Upgrading</a>
                             
                             
                        </li>
                    </ul>
                        </li>
                        <li>
                            <a href="/api/auth/">Authentication plugins</a>
                        </li>
                        <li>
                            <a href="/api/buckets/">Bucket handlers</a>
                        </li>
                        <li>
                            <a href="/api/custom-ui/">UI Customisations</a>
                        </li>
                        <li>
                            <a href="/api/dashboard/">Dashboard Widgets</a>
                        </li>
                        <li>
                            <a href="/api/editors/">Editor plugins</a>
                        </li>
                        <li>
                            <a href="/api/events/">Event hooks</a>
                             
                        </li>
                        <li>
                            <a href="/api/template-filters/">Template filters</a>
                        </li>
                        <li>
                            <a href="/api/templates/">Template handlers</a>
                        </li>
                        <li>
                            <a href="/api/field-types/">Field Types</a>
                        </li>
                        <li>
                            <a href="/api/validators/">Form validators</a>
                        </li>
                        <li>
                            <a href="/api/search/">Search handlers</a>
                        </li>
                        <li>
                            <a href="/api/shortcodes/">Shortcode providers</a>
                        </li>
                        <li>
                            <a href="/api/translations/">Translations</a>
                        </li>
                        <li>
                            <a href="/api/feathers/">Feathers</a>
                        </li>
                        <li>
                            <a href="/api/import/">Importing Content</a>
                             
                             
                             
                             
                        </li>
                        <li>
                            <a href="/api/reference/">API Reference</a>
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        </li>
    </ul>  </nav>

<article class="content">


  <h1>Runtime functions</h1>

  <p>Apps that expose PHP functions to the user’s page should create a file at <code>perch/addons/apps/my_app/runtime.php</code>. Admin-only apps don’t need this file.</p>
<p>This runtime.php file will be included in the user’s pages. You should declare your functions within it.</p>
<h2 id="including-the-file">Including the file</h2>
<p>Unlike admin.php which is automatically included at edit time, the runtime file is not automatically included by Perch. This is to reduce overhead, as the process occurs for every page load. Searching for runtime files to include would be a waste.</p>
<p>Instead, you need to add it to <code>perch/config/apps.php</code> – and will need to instruct users to do the same as part of the installation procedure if you intend to distribute the app. You can see examples of this in the installation documentation for our official apps.</p>
<h2 id="autoloading">Autoloading</h2>
<p>The <code>runtime.php</code> file is also the place to add your app’s autoloader for any classes needed by your page functions.</p>
<pre><code class="lang-php">spl_autoload_register(function($class_name){
    if (strpos($class_name, &#39;MyApp_&#39;)===0) {
        include(PERCH_PATH.&#39;/addons/apps/my_app/lib/&#39;.$class_name.&#39;.class.php&#39;);
        return true;
    }
    return false;
});
</code></pre>
<h2 id="search-handlers">Search handlers</h2>
<p>If your app uses a <a href="/api/search/">search handler</a>, you can also register that in your <code>runtime.php</code> file.</p>
<pre><code class="lang-php">PerchSystem::register_search_handler(&#39;MyApp_SearchHandler&#39;);
</code></pre>
<h2 id="template-handers">Template handers</h2>
<p>If your app uses a <a href="/api/templates/">template handler</a> for handling custom template tags, you can also register that in your <code>runtime.php</code> file.</p>
<pre><code class="lang-php">PerchSystem::register_template_handler(&#39;MyApp_Template&#39;);
</code></pre>
<h2 id="form-handler">Form handler</h2>
<p>If your app needs to handle forms, you can add a form handler function. Perch will call this function when a <a href="/templates/form/">Perch-templated form</a> that specifies your app as the handler is submitted:</p>
<pre><code class="lang-html">&lt;perch:form id=&quot;register&quot; app=&quot;my_app&quot; method=&quot;post&quot;&gt;&lt;/perch:form&gt;
</code></pre>
<p>Your function must be called <code>{your_app_ID}_form_handler</code>:</p>
<pre><code class="lang-php">function my_app_form_handler($SubmittedForm) {}
</code></pre>
<p>The form handler receives a <a href="/api/reference/perchapi-submittedform">PerchAPI_SubmittedForm</a>, which you can use to validate the submission and access the submitted data and uploaded files.</p>

</article>




</main>
<footer>
</footer>
<script async src="https://cse.google.com/cse.js?cx=007560778035763025039:043iekruiov"></script>
<script src="/assets/js/prism.js" async defer></script>
<script>
    if ("classList" in document.createElement("_")) {
        var hb = document.querySelectorAll('.hamburger');
        if (hb.length) {
            hb[0].addEventListener('click', function(e) {
                e.preventDefault();
                var nav = document.querySelectorAll('nav.primary')[0];
                if (!nav.classList.contains('show')) {
                    nav.classList.remove('show-for-medium', 'hide');
                    nav.classList.add('show');
                } else {
                    nav.classList.remove('show');
                    nav.classList.add('hide');
                }
            });
        }
    }


        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8618320-3']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

</script>
</body>
</html>
